<!-- Semantic HTML, SEO, and Accessibility improvements are present throughout. -->
<!DOCTYPE html>
<html lang="en">
<head>
	<!-- This is an SEO Change -->
	<meta charset="UTF-8">
	<!-- This is an SEO Change -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- This is an SEO Change -->
	<meta name="description" content="Login to Maria James Personal Budget App">
	<meta name="keywords" content="login, personal budget, Maria James">
	<!-- SEO Change: This meta tag tells search engines who the author is -->
	<meta name="author" content="Maria James">
	<!-- SEO Change: This link helps search engines avoid duplicate content issues -->
	<link rel="canonical" href="http://159.89.189.21/login.html">
	<!-- SEO Change: This tag improves how the page looks when shared on social media -->
	<meta property="og:title" content="Login - Maria James Personal Budget App">
	<link rel="stylesheet" href="reset.css">
	<link rel="stylesheet" href="main.css">
	<style>
		body {
			min-height: 100vh;
			display: flex;
			flex-direction: column;
		}
		.hero-bg {
			background: url('bg.png') no-repeat center center;
			background-size: cover;
			min-height: 400px;
			width: 100%;
			position: relative;
			display: flex;
			flex-direction: column;
			justify-content: center;
		}
		.hero {
			text-align: center;
			color: #fff;
			margin-top: 60px;
		}
		.page-area {
			background: rgba(255,255,255,0.95);
			padding: 2em 2em 2em 2em;
			border-radius: 8px;
			box-shadow: 0 2px 8px rgba(0,0,0,0.08);
			max-width: 450px;
			margin: 40px auto 2em auto;
			position: relative;
			z-index: 2;
		}
		
		/* Form styling */
		.login-form, .signup-form {
			width: 100%;
		}
		
		.login-form label, .signup-form label {
			display: block;
			margin: 0.8em 0 0.3em 0;
			font-weight: bold;
			color: #333;
		}
		
		.login-form input, .signup-form input {
			width: 100%;
			padding: 0.8em;
			border: 1px solid #ddd;
			border-radius: 4px;
			box-sizing: border-box;
			font-size: 1em;
		}
		
		.login-form input:focus, .signup-form input:focus {
			border-color: #007bff;
			outline: none;
			box-shadow: 0 0 5px rgba(0,123,255,0.3);
		}
		
		.login-form button, .signup-form button {
			width: 100%;
			margin-top: 1em;
			font-size: 1em;
			transition: background-color 0.3s;
		}
		
		.login-form button:hover {
			background-color: #0056b3 !important;
		}
		
		.signup-form button:hover {
			background-color: #218838 !important;
		}
		.page-area h1 {
			margin-top: 0;
			font-size: 1.5em;
		}
		.login-form {
			display: flex;
			flex-direction: column;
			gap: 1em;
		}
		.login-form label {
			font-weight: bold;
		}
		.login-form input {
			padding: 0.5em;
			border-radius: 4px;
			border: 1px solid #ccc;
		}
		.login-form button {
			padding: 0.7em;
			border-radius: 4px;
			border: none;
			background: #36a2eb;
			color: #fff;
			font-weight: bold;
			cursor: pointer;
		}
		footer.bottom {
			width: 100%;
			background: #bcd1f7;
			padding: 1em 0;
			text-align: center;
			margin-top: auto;
		}
	</style>
</head>
<!-- This is a Semantic HTML Change -->
<body>
<!-- This is a Semantic HTML Change -->
<header>
	<div class="top-banner" style="background:#f5f5f5; padding:1em 0; text-align:center; position:relative;">
	<!-- This is an A11y Change -->
	<a href="#main" class="skip" style="position:absolute;left:0;top:0;padding:0.5em 1em;background:#222;color:#fff;text-decoration:none;z-index:1000;border-radius:0 0 4px 0;">Skip to main content</a>
		<span style="font-weight:bold; font-size:1.2em;">Maria James Personal Budget App</span>
	</div>
	<!-- This is a Semantic HTML Change -->
	<nav aria-label="Main navigation">
		<ul>
			<li><a href="./">Home</a></li>
			<li><a href="./about.html">About</a></li>
			<li><a href="./login.html">Login</a></li>
			<li><a href="https://google.com">Google</a></li>
		</ul>
	</nav>
	<div class="hero-bg">
		<div class="hero">
			<h1 style="font-size:2.5em; font-weight:bold;">Login</h1>
			<h2 style="font-size:1.2em; font-weight:normal;">Access your personal budget account</h2>
		</div>
	</div>
</header>
<!-- This is a Semantic HTML Change -->
<main class="center" id="main">
	<!-- This is a Semantic HTML Change -->
	<div class="page-area">
	<!-- Login Form -->
	<form class="login-form" aria-label="Login form" id="loginForm" style="display: block;">
		<h2>Login to Your Account</h2>
		<label for="loginUsername">Username</label>
		<input type="text" id="loginUsername" name="username" required>
		
		<label for="loginPassword">Password</label>
		<input type="password" id="loginPassword" name="password" required>
		
		<button type="submit" style="background-color: #007bff; color: white; padding: 0.8em 1.5em; border: none; border-radius: 4px; cursor: pointer; margin: 0.5em 0;">Login</button>
		
		<p style="text-align: center; margin: 1em 0;">
			Don't have an account? 
			<button type="button" onclick="showSignupForm()" style="background: none; border: none; color: #007bff; cursor: pointer; text-decoration: underline;">Sign Up Here</button>
		</p>
		
		<div id="loginMessage"></div>
	</form>

	<!-- Signup Form -->
	<form class="signup-form" aria-label="Signup form" id="signupForm" style="display: none;">
		<h2>Create New Account</h2>
		<label for="signupUsername">Username *</label>
		<input type="text" id="signupUsername" name="username" required>
		
		<label for="signupPassword">Password *</label>
		<input type="password" id="signupPassword" name="password" required>
		
		<label for="signupEmail">Email</label>
		<input type="email" id="signupEmail" name="email">
		
		<label for="signupFirstName">First Name</label>
		<input type="text" id="signupFirstName" name="first_name">
		
		<label for="signupLastName">Last Name</label>
		<input type="text" id="signupLastName" name="last_name">
		
		<button type="submit" style="background-color: #28a745; color: white; padding: 0.8em 1.5em; border: none; border-radius: 4px; cursor: pointer; margin: 0.5em 0;">Create Account</button>
		
		<p style="text-align: center; margin: 1em 0;">
			Already have an account? 
			<button type="button" onclick="showLoginForm()" style="background: none; border: none; color: #007bff; cursor: pointer; text-decoration: underline;">Login Here</button>
		</p>
		
		<div id="signupMessage"></div>
	</form>
	</div>
</main>
	<!-- This is a Semantic HTML Change -->
	<footer class="bottom">
	<div class="center">
		All rights reserved &copy; Maria James
	</div>
</footer>

<script>
// Function to show signup form and hide login form
function showSignupForm() {
    document.getElementById('loginForm').style.display = 'none';
    document.getElementById('signupForm').style.display = 'block';
    document.querySelector('.hero h1').textContent = 'Sign Up';
    document.querySelector('.hero h2').textContent = 'Create your personal budget account';
}

// Function to show login form and hide signup form
function showLoginForm() {
    document.getElementById('signupForm').style.display = 'none';
    document.getElementById('loginForm').style.display = 'block';
    document.querySelector('.hero h1').textContent = 'Login';
    document.querySelector('.hero h2').textContent = 'Access your personal budget account';
}

// Handle login form submission
document.getElementById('loginForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const messageDiv = document.getElementById('loginMessage');
    messageDiv.innerHTML = '<p>Logging in...</p>';
    
    const username = document.getElementById('loginUsername').value;
    const password = document.getElementById('loginPassword').value;
    
    try {
        const response = await fetch('/login', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ username, password })
        });
        
        const data = await response.json();
        
        if (response.ok) {
            messageDiv.innerHTML = `
                <div style="color: green; padding: 10px; background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 4px; margin: 10px 0;">
                    <h3>✅ Login Successful!</h3>
                    <p>Welcome, ${data.data.username}!</p>
                    <p>Redirecting to homepage...</p>
                </div>
            `;
            
            // Store user data and redirect after 2 seconds
            localStorage.setItem('currentUser', JSON.stringify(data.data));
            setTimeout(() => {
                window.location.href = '/';
            }, 2000);
            
        } else {
            messageDiv.innerHTML = `
                <div style="color: red; padding: 10px; background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px; margin: 10px 0;">
                    <h3>❌ Login Failed</h3>
                    <p>${data.message}</p>
                </div>
            `;
        }
    } catch (error) {
        messageDiv.innerHTML = `
            <div style="color: red; padding: 10px; background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px; margin: 10px 0;">
                <h3>❌ Network Error</h3>
                <p>Unable to connect to server. Please try again.</p>
            </div>
        `;
    }
});

// Handle signup form submission
document.getElementById('signupForm').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const messageDiv = document.getElementById('signupMessage');
    messageDiv.innerHTML = '<p>Creating account...</p>';
    
    const formData = {
        username: document.getElementById('signupUsername').value,
        password: document.getElementById('signupPassword').value,
        email: document.getElementById('signupEmail').value || null,
        first_name: document.getElementById('signupFirstName').value || null,
        last_name: document.getElementById('signupLastName').value || null
    };
    
    try {
        const response = await fetch('/signup', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
        });
        
        const data = await response.json();
        
        if (response.ok) {
            messageDiv.innerHTML = `
                <div style="color: green; padding: 10px; background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 4px; margin: 10px 0;">
                    <h3>✅ Account Created Successfully!</h3>
                    <p>Welcome, ${data.data.username}!</p>
                    <p>You can now login with your credentials.</p>
                </div>
            `;
            
            // Clear the form and switch to login after 3 seconds
            document.getElementById('signupForm').reset();
            setTimeout(() => {
                showLoginForm();
                document.getElementById('loginUsername').value = formData.username;
            }, 3000);
            
        } else {
            messageDiv.innerHTML = `
                <div style="color: red; padding: 10px; background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px; margin: 10px 0;">
                    <h3>❌ Signup Failed</h3>
                    <p>${data.message}</p>
                </div>
            `;
        }
    } catch (error) {
        messageDiv.innerHTML = `
            <div style="color: red; padding: 10px; background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 4px; margin: 10px 0;">
                <h3>❌ Network Error</h3>
                <p>Unable to connect to server. Please try again.</p>
            </div>
        `;
    }
});
</script>

</body>
</html>